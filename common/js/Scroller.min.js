var Scroller;!function(){Scroller=function(e,_){this.__callback=e,this.options={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3};for(var o in _)this.options[o]=_[o]};var e=function(e){return Math.pow(e-1,3)+1},_=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},o={__isSingleTouch:!1,__isTracking:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:!1,__isAnimating:!1,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setDimensions:function(e,_,o,t){var l=this;e&&(l.__clientWidth=e),_&&(l.__clientHeight=_),o&&(l.__contentWidth=o),t&&(l.__contentHeight=t),l.__computeScrollMax(),l.scrollTo(l.__scrollLeft,l.__scrollTop,!0)},setPosition:function(e,_){var o=this;o.__clientLeft=e||0,o.__clientTop=_||0},setSnapSize:function(e,_){var o=this;o.__snapWidth=e,o.__snapHeight=_},activatePullToRefresh:function(e,_,o,t){var l=this;l.__refreshHeight=e,l.__refreshActivate=_,l.__refreshDeactivate=o,l.__refreshStart=t},finishPullToRefresh:function(){var e=this;e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},getValues:function(){var e=this;return{left:e.__scrollLeft,top:e.__scrollTop,zoom:e.__zoomLevel}},getScrollMax:function(){var e=this;return{left:e.__maxScrollLeft,top:e.__maxScrollTop}},zoomTo:function(e,_,o,t){var l=this;if(!l.options.zooming)throw new Error("Zooming is not enabled!");l.__isDecelerating&&(core.effect.Animate.stop(l.__isDecelerating),l.__isDecelerating=!1);var i=l.__zoomLevel;null==o&&(o=l.__clientWidth/2),null==t&&(t=l.__clientHeight/2),e=Math.max(Math.min(e,l.options.maxZoom),l.options.minZoom),l.__computeScrollMax(e);var n=(o+l.__scrollLeft)*e/i-o,r=(t+l.__scrollTop)*e/i-t;n>l.__maxScrollLeft?n=l.__maxScrollLeft:0>n&&(n=0),r>l.__maxScrollTop?r=l.__maxScrollTop:0>r&&(r=0),l.__publish(n,r,e,_)},zoomBy:function(e,_,o,t){var l=this;l.zoomTo(l.__zoomLevel*e,_,o,t)},scrollTo:function(e,_,o,t){var l=this;if(l.__isDecelerating&&(core.effect.Animate.stop(l.__isDecelerating),l.__isDecelerating=!1),null!=t&&t!==l.__zoomLevel){if(!l.options.zooming)throw new Error("Zooming is not enabled!");e*=t,_*=t,l.__computeScrollMax(t)}else t=l.__zoomLevel;l.options.scrollingX?l.options.paging?e=Math.round(e/l.__clientWidth)*l.__clientWidth:l.options.snapping&&(e=Math.round(e/l.__snapWidth)*l.__snapWidth):e=l.__scrollLeft,l.options.scrollingY?l.options.paging?_=Math.round(_/l.__clientHeight)*l.__clientHeight:l.options.snapping&&(_=Math.round(_/l.__snapHeight)*l.__snapHeight):_=l.__scrollTop,e=Math.max(Math.min(l.__maxScrollLeft,e),0),_=Math.max(Math.min(l.__maxScrollTop,_),0),e===l.__scrollLeft&&_===l.__scrollTop&&(o=!1),l.__publish(e,_,t,o)},scrollBy:function(e,_,o){var t=this,l=t.__isAnimating?t.__scheduledLeft:t.__scrollLeft,i=t.__isAnimating?t.__scheduledTop:t.__scrollTop;t.scrollTo(l+(e||0),i+(_||0),o)},doMouseZoom:function(e,_,o,t){var l=this,i=e>0?.97:1.03;return l.zoomTo(l.__zoomLevel*i,!1,o-l.__clientLeft,t-l.__clientTop)},doTouchStart:function(e,_){if(null==e.length)throw new Error("Invalid touch list: "+e);if(_ instanceof Date&&(_=_.valueOf()),"number"!=typeof _)throw new Error("Invalid timestamp value: "+_);var o=this;o.__isDecelerating&&(core.effect.Animate.stop(o.__isDecelerating),o.__isDecelerating=!1),o.__isAnimating&&(core.effect.Animate.stop(o.__isAnimating),o.__isAnimating=!1);var t,l,i=1===e.length;i?(t=e[0].pageX,l=e[0].pageY):(t=Math.abs(e[0].pageX+e[1].pageX)/2,l=Math.abs(e[0].pageY+e[1].pageY)/2),o.__initialTouchLeft=t,o.__initialTouchTop=l,o.__zoomLevelStart=o.__zoomLevel,o.__lastTouchLeft=t,o.__lastTouchTop=l,o.__lastTouchMove=_,o.__lastScale=1,o.__enableScrollX=!i&&o.options.scrollingX,o.__enableScrollY=!i&&o.options.scrollingY,o.__isTracking=!0,o.__isDragging=!i,o.__isSingleTouch=i,o.__positions=[]},doTouchMove:function(e,_,o){if(null==e.length)throw new Error("Invalid touch list: "+e);if(_ instanceof Date&&(_=_.valueOf()),"number"!=typeof _)throw new Error("Invalid timestamp value: "+_);var t=this;if(t.__isTracking){var l,i;2===e.length?(l=Math.abs(e[0].pageX+e[1].pageX)/2,i=Math.abs(e[0].pageY+e[1].pageY)/2):(l=e[0].pageX,i=e[0].pageY);var n=t.__positions;if(t.__isDragging){var r=l-t.__lastTouchLeft,a=i-t.__lastTouchTop,c=t.__scrollLeft,s=t.__scrollTop,h=t.__zoomLevel;if(null!=o&&t.options.zooming){var f=h;if(h=h/t.__lastScale*o,h=Math.max(Math.min(h,t.options.maxZoom),t.options.minZoom),f!==h){var p=l-t.__clientLeft,m=i-t.__clientTop;c=(p+c)*h/f-p,s=(m+s)*h/f-m,t.__computeScrollMax(h)}}if(t.__enableScrollX){c-=r;var g=t.__maxScrollLeft;(c>g||0>c)&&(t.options.bouncing?c+=r/2:c=c>g?g:0)}if(t.__enableScrollY){s-=a;var u=t.__maxScrollTop;(s>u||0>s)&&(t.options.bouncing?(s+=a/2,t.__enableScrollX||null==t.__refreshHeight||(!t.__refreshActive&&s<=-t.__refreshHeight?(t.__refreshActive=!0,t.__refreshActivate&&t.__refreshActivate()):t.__refreshActive&&s>-t.__refreshHeight&&(t.__refreshActive=!1,t.__refreshDeactivate&&t.__refreshDeactivate()))):s=s>u?u:0)}n.length>60&&n.splice(0,30),n.push(c,s,_),t.__publish(c,s,h)}else{var v=t.options.locking?3:0,T=5,S=Math.abs(l-t.__initialTouchLeft),L=Math.abs(i-t.__initialTouchTop);t.__enableScrollX=t.options.scrollingX&&S>=v,t.__enableScrollY=t.options.scrollingY&&L>=v,n.push(t.__scrollLeft,t.__scrollTop,_),t.__isDragging=(t.__enableScrollX||t.__enableScrollY)&&(S>=T||L>=T)}t.__lastTouchLeft=l,t.__lastTouchTop=i,t.__lastTouchMove=_,t.__lastScale=o}},doTouchEnd:function(e){if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e);var _=this;if(_.__isTracking){if(_.__isTracking=!1,_.__isDragging&&(_.__isDragging=!1,_.__isSingleTouch&&_.options.animating&&e-_.__lastTouchMove<=100)){for(var o=_.__positions,t=o.length-1,l=t,i=t;i>0&&o[i]>_.__lastTouchMove-100;i-=3)l=i;if(l!==t){var n=o[t]-o[l],r=_.__scrollLeft-o[l-2],a=_.__scrollTop-o[l-1];_.__decelerationVelocityX=r/n*(1e3/60),_.__decelerationVelocityY=a/n*(1e3/60);var c=_.options.paging||_.options.snapping?4:1;(Math.abs(_.__decelerationVelocityX)>c||Math.abs(_.__decelerationVelocityY)>c)&&(_.__refreshActive||_.__startDeceleration(e))}}_.__isDecelerating||(_.__refreshActive&&_.__refreshStart?(_.__publish(_.__scrollLeft,-_.__refreshHeight,_.__zoomLevel,!0),_.__refreshStart&&_.__refreshStart()):(_.scrollTo(_.__scrollLeft,_.__scrollTop,!0,_.__zoomLevel),_.__refreshActive&&(_.__refreshActive=!1,_.__refreshDeactivate&&_.__refreshDeactivate()))),_.__positions.length=0}},__publish:function(o,t,l,i){var n=this,r=n.__isAnimating;if(r&&(core.effect.Animate.stop(r),n.__isAnimating=!1),i&&n.options.animating){n.__scheduledLeft=o,n.__scheduledTop=t,n.__scheduledZoom=l;var a=n.__scrollLeft,c=n.__scrollTop,s=n.__zoomLevel,h=o-a,f=t-c,p=l-s,m=function(e,_,o){o&&(n.__scrollLeft=a+h*e,n.__scrollTop=c+f*e,n.__zoomLevel=s+p*e,n.__callback&&n.__callback(n.__scrollLeft,n.__scrollTop,n.__zoomLevel))},g=function(e){return n.__isAnimating===e},u=function(e,_,o){_===n.__isAnimating&&(n.__isAnimating=!1),n.options.zooming&&n.__computeScrollMax()};n.__isAnimating=core.effect.Animate.start(m,g,u,n.options.animationDuration,r?e:_)}else n.__scheduledLeft=n.__scrollLeft=o,n.__scheduledTop=n.__scrollTop=t,n.__scheduledZoom=n.__zoomLevel=l,n.__callback&&n.__callback(o,t,l),n.options.zooming&&n.__computeScrollMax()},__computeScrollMax:function(e){var _=this;null==e&&(e=_.__zoomLevel),_.__maxScrollLeft=Math.max(_.__contentWidth*e-_.__clientWidth,0),_.__maxScrollTop=Math.max(_.__contentHeight*e-_.__clientHeight,0)},__startDeceleration:function(e){var _=this;if(_.options.paging){var o=Math.max(Math.min(_.__scrollLeft,_.__maxScrollLeft),0),t=Math.max(Math.min(_.__scrollTop,_.__maxScrollTop),0),l=_.__clientWidth,i=_.__clientHeight;_.__minDecelerationScrollLeft=Math.floor(o/l)*l,_.__minDecelerationScrollTop=Math.floor(t/i)*i,_.__maxDecelerationScrollLeft=Math.ceil(o/l)*l,_.__maxDecelerationScrollTop=Math.ceil(t/i)*i}else _.__minDecelerationScrollLeft=0,_.__minDecelerationScrollTop=0,_.__maxDecelerationScrollLeft=_.__maxScrollLeft,_.__maxDecelerationScrollTop=_.__maxScrollTop;var n=function(e,o,t){_.__stepThroughDeceleration(t)},r=_.options.snapping?4:.1,a=function(){return Math.abs(_.__decelerationVelocityX)>=r||Math.abs(_.__decelerationVelocityY)>=r},c=function(e,o,t){_.__isDecelerating=!1,_.scrollTo(_.__scrollLeft,_.__scrollTop,_.options.snapping)};_.__isDecelerating=core.effect.Animate.start(n,a,c)},__stepThroughDeceleration:function(e){var _=this,o=_.__scrollLeft+_.__decelerationVelocityX,t=_.__scrollTop+_.__decelerationVelocityY;if(!_.options.bouncing){var l=Math.max(Math.min(_.__maxDecelerationScrollLeft,o),_.__minDecelerationScrollLeft);l!==o&&(o=l,_.__decelerationVelocityX=0);var i=Math.max(Math.min(_.__maxDecelerationScrollTop,t),_.__minDecelerationScrollTop);i!==t&&(t=i,_.__decelerationVelocityY=0)}if(e?_.__publish(o,t,_.__zoomLevel):(_.__scrollLeft=o,_.__scrollTop=t),!_.options.paging){var n=.95;_.__decelerationVelocityX*=n,_.__decelerationVelocityY*=n}if(_.options.bouncing){var r=0,a=0,c=.03,s=.08;o<_.__minDecelerationScrollLeft?r=_.__minDecelerationScrollLeft-o:o>_.__maxDecelerationScrollLeft&&(r=_.__maxDecelerationScrollLeft-o),t<_.__minDecelerationScrollTop?a=_.__minDecelerationScrollTop-t:t>_.__maxDecelerationScrollTop&&(a=_.__maxDecelerationScrollTop-t),0!==r&&(r*_.__decelerationVelocityX<=0?_.__decelerationVelocityX+=r*c:_.__decelerationVelocityX=r*s),0!==a&&(a*_.__decelerationVelocityY<=0?_.__decelerationVelocityY+=a*c:_.__decelerationVelocityY=a*s)}}};for(var t in o)Scroller.prototype[t]=o[t]}();